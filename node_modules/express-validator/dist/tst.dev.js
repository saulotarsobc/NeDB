"use strict";

var expressValidator = require('./');

var _require = require('./check'),
    check = _require.check,
    checkSchema = _require.checkSchema,
    oneOf = _require.oneOf,
    validationResult = _require.validationResult;

var _require2 = require('./filter'),
    matchedData = _require2.matchedData;

var express = require('express');

var bodyParser = require('body-parser');

var app = express();
app.use(bodyParser.json());
app.use(bodyParser.text());
app.all('/*', [check('id').escape()], function (req, res) {
  var data = matchedData(req, {
    onlyValidData: false
  });
  var result = validationResult(req);
  res.json({
    data: data,
    errors: result.array()
  });
}); // app.use(expressValidator());
// app.use((req, res) => {
//   req.checkBody('id').custom(value => {
//     return new Promise(resolve => {
//       setTimeout(() => {
//         resolve();
//       }, 3000);
//     });
//   });
//   req.checkBody({
//     id: {
//       notEmpty: { errorMessage: 'not empty' }
//     }
//   });
//   req.getValidationResult().then(result => {
//     res.json({
//       errors: result.mapped()
//     });
//   });
// });

app.listen(3001);